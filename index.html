<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Moodtracker</title>
</head>
<body>
<div>
   <!-- <input id="mood" type="number" min="1" max="5" onchange="grabMood()">-->
    <button onclick="grabMood" value="1">1: Super Low mood</button>
    <button onclick="grabMood" value="2">2: Low mood</button>
    <button onclick="grabMood" value="3">3: Medium mood</button>
    <button onclick="grabMood" value="4">4: Good mood</button>
    <button onclick="grabMood" value="5">5: AWESOME mood</button>
    <br />
    <br />
    <button onclick="checkSend">When you have selected a mood, click here to send to the database</button>

</div>

    <script>

        var dataToSend = {"mood": "", "date": "2016-11-06 23:00:25.689784"}
       
        //for later use to parse a return message
        function JSONparser(m)
        {
            try {
                return JSON.parse(m); 
            }
            catch (err) {
                console.log("there was a parsing error" + err)
                // later:         message.innerHTML = "Input is " + err;
            }
            //might be possible to add a finally that would refresh or reset? =x
        }

        //read a message and print.  Will expand later
        function readMessage(m) {
            console.log("message received:" + m)
        }

        //takes JSON data from a previously executed function, sends it to server, gets data back
        function webSocketConnection(JSONdata)
        {
            var connection = new WebSocket("ws://mood.gretaparks.com:8080");

            //send data
            //note: event stays.  It is good practice to always match method signatures
            connection.onopen = function (event) {
                connection.send(JSONdata);
                console.log("JSONdata sent");
            }

            //receive a message from server
            connection.onmessage = function (m) {
                console.log("Recieved message from server" + m.data);
                //SEND data to a parser, which will update the site.
                //possibly close connection here: connection.close()
            }
        }

        //grabs mood from HTML, inserts it into JSON string
        function grabMood() {
            var x = document.getElementById("mood").value;
            dataToSend["mood"] = x
            console.log(dataToSend + "<--is the current dictionary datatoSend")
        }

        function checkSend() {
            if dataToSend["mood"] = null
        }

        
        /*
        OLD testing run
        data = '{"mood": 4, "date": "2016-11-06 23:00:25.689784"}'
        webSocketConnection(data)
        */
    </script>

</body>
</html>